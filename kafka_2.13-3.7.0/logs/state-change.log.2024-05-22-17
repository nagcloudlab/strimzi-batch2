[2024-05-22 17:12:33,158] INFO [Broker id=102] Handling LeaderAndIsr request correlationId 26 from controller 101 for 1 partitions (state.change.logger)
[2024-05-22 17:12:33,159] INFO [Broker id=102] Follower topic1-2 starts at leader epoch 1 from offset 0 with partition epoch 1 and high watermark 0. Current leader is 103. Previous leader Some(103) and previous leader epoch was 1. (state.change.logger)
[2024-05-22 17:12:33,160] INFO [Broker id=102] Stopped fetchers as part of become-follower request from controller 101 epoch 1 with correlation id 26 for 1 partitions (state.change.logger)
[2024-05-22 17:12:33,165] INFO [Broker id=102] Finished LeaderAndIsr request in 7ms correlationId 26 from controller 101 for 1 partitions (state.change.logger)
[2024-05-22 17:12:33,166] INFO [Broker id=102] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 1 with correlation id 27 (state.change.logger)
[2024-05-22 17:12:33,166] INFO [Broker id=102] Handling LeaderAndIsr request correlationId 28 from controller 101 for 2 partitions (state.change.logger)
[2024-05-22 17:12:33,166] INFO [Broker id=102] Stopped fetchers as part of LeaderAndIsr request correlationId 28 from controller 101 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-05-22 17:12:33,167] INFO [Broker id=102] Leader topic1-1 with topic id Some(3FJG66WbRtuLJvoJ69Ijiw) starts at leader epoch 1 from offset 210 with partition epoch 1, high watermark 210, ISR [102,103], adding replicas [] and removing replicas [] . Previous leader Some(102) and previous leader epoch was 0. (state.change.logger)
[2024-05-22 17:12:33,171] INFO [Broker id=102] Follower topic1-0 starts at leader epoch 1 from offset 0 with partition epoch 1 and high watermark 0. Current leader is 103. Previous leader Some(103) and previous leader epoch was 1. (state.change.logger)
[2024-05-22 17:12:33,171] INFO [Broker id=102] Stopped fetchers as part of become-follower request from controller 101 epoch 1 with correlation id 28 for 1 partitions (state.change.logger)
[2024-05-22 17:12:33,171] INFO [Broker id=102] Finished LeaderAndIsr request in 5ms correlationId 28 from controller 101 for 2 partitions (state.change.logger)
[2024-05-22 17:12:33,172] INFO [Broker id=102] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 101 epoch 1 with correlation id 29 (state.change.logger)
[2024-05-22 17:12:33,257] INFO [Broker id=102] Handling LeaderAndIsr request correlationId 1 from controller 103 for 3 partitions (state.change.logger)
[2024-05-22 17:12:33,258] INFO [Broker id=102] Ignoring LeaderAndIsr request from controller 103 with correlation id 1 epoch 2 for partition topic1-1 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-05-22 17:12:33,258] INFO [Broker id=102] Ignoring LeaderAndIsr request from controller 103 with correlation id 1 epoch 2 for partition topic1-0 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-05-22 17:12:33,258] INFO [Broker id=102] Ignoring LeaderAndIsr request from controller 103 with correlation id 1 epoch 2 for partition topic1-2 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-05-22 17:12:33,258] INFO [Broker id=102] Finished LeaderAndIsr request in 1ms correlationId 1 from controller 103 for 3 partitions (state.change.logger)
[2024-05-22 17:12:33,259] INFO [Broker id=102] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 103 epoch 2 with correlation id 2 (state.change.logger)
[2024-05-22 17:12:33,262] INFO [Broker id=102] Handling LeaderAndIsr request correlationId 3 from controller 103 for 3 partitions (state.change.logger)
[2024-05-22 17:12:33,262] INFO [Broker id=102] Ignoring LeaderAndIsr request from controller 103 with correlation id 3 epoch 2 for partition topic1-1 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-05-22 17:12:33,262] INFO [Broker id=102] Ignoring LeaderAndIsr request from controller 103 with correlation id 3 epoch 2 for partition topic1-0 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-05-22 17:12:33,262] INFO [Broker id=102] Ignoring LeaderAndIsr request from controller 103 with correlation id 3 epoch 2 for partition topic1-2 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-05-22 17:12:33,262] INFO [Broker id=102] Finished LeaderAndIsr request in 0ms correlationId 3 from controller 103 for 3 partitions (state.change.logger)
[2024-05-22 17:12:33,263] INFO [Broker id=102] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 103 epoch 2 with correlation id 4 (state.change.logger)
[2024-05-22 17:15:55,494] INFO [Broker id=102] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 103 epoch 2 with correlation id 6 (state.change.logger)
[2024-05-22 17:15:55,620] INFO [Broker id=101] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 103 epoch 2 with correlation id 0 (state.change.logger)
[2024-05-22 17:15:55,635] INFO [Broker id=101] Handling LeaderAndIsr request correlationId 1 from controller 103 for 3 partitions (state.change.logger)
[2024-05-22 17:15:55,650] INFO [Broker id=101] Follower topic1-1 starts at leader epoch 1 from offset 210 with partition epoch 1 and high watermark 209. Current leader is 102. Previous leader Some(102) and previous leader epoch was 1. (state.change.logger)
[2024-05-22 17:15:55,650] INFO [Broker id=101] Follower topic1-2 starts at leader epoch 1 from offset 0 with partition epoch 1 and high watermark 0. Current leader is 103. Previous leader Some(103) and previous leader epoch was 1. (state.change.logger)
[2024-05-22 17:15:55,650] INFO [Broker id=101] Follower topic1-0 starts at leader epoch 1 from offset 0 with partition epoch 1 and high watermark 0. Current leader is 103. Previous leader Some(103) and previous leader epoch was 1. (state.change.logger)
[2024-05-22 17:15:55,652] INFO [Broker id=101] Stopped fetchers as part of become-follower request from controller 103 epoch 2 with correlation id 1 for 3 partitions (state.change.logger)
[2024-05-22 17:15:55,676] INFO [Broker id=101] Finished LeaderAndIsr request in 41ms correlationId 1 from controller 103 for 3 partitions (state.change.logger)
[2024-05-22 17:15:55,679] INFO [Broker id=101] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 103 epoch 2 with correlation id 2 (state.change.logger)
[2024-05-22 17:15:55,706] INFO [Broker id=102] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 103 epoch 2 with correlation id 7 (state.change.logger)
[2024-05-22 17:15:55,707] INFO [Broker id=101] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 103 epoch 2 with correlation id 3 (state.change.logger)
[2024-05-22 17:15:55,714] INFO [Broker id=102] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 103 epoch 2 with correlation id 8 (state.change.logger)
[2024-05-22 17:15:55,715] INFO [Broker id=101] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 103 epoch 2 with correlation id 4 (state.change.logger)
[2024-05-22 17:15:55,717] INFO [Broker id=102] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 103 epoch 2 with correlation id 9 (state.change.logger)
[2024-05-22 17:15:55,718] INFO [Broker id=101] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 103 epoch 2 with correlation id 5 (state.change.logger)
[2024-05-22 17:16:42,158] INFO [Broker id=102] Handling LeaderAndIsr request correlationId 10 from controller 103 for 1 partitions (state.change.logger)
[2024-05-22 17:16:42,158] INFO [Broker id=102] Follower topic1-1 starts at leader epoch 2 from offset 459 with partition epoch 3 and high watermark 459. Current leader is 101. Previous leader Some(101) and previous leader epoch was 2. (state.change.logger)
[2024-05-22 17:16:42,158] INFO [Broker id=101] Handling LeaderAndIsr request correlationId 6 from controller 103 for 1 partitions (state.change.logger)
[2024-05-22 17:16:42,158] INFO [Broker id=102] Stopped fetchers as part of become-follower request from controller 103 epoch 2 with correlation id 10 for 1 partitions (state.change.logger)
[2024-05-22 17:16:42,161] INFO [Broker id=102] Finished LeaderAndIsr request in 3ms correlationId 10 from controller 103 for 1 partitions (state.change.logger)
[2024-05-22 17:16:42,162] INFO [Broker id=102] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 103 epoch 2 with correlation id 11 (state.change.logger)
[2024-05-22 17:16:42,162] INFO [Broker id=102] Handling StopReplica request correlationId 12 from controller 103 for 2 partitions (state.change.logger)
[2024-05-22 17:16:42,163] INFO [Broker id=101] Stopped fetchers as part of LeaderAndIsr request correlationId 6 from controller 103 epoch 2 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-05-22 17:16:42,166] INFO [Broker id=102] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 103 epoch 2 with correlation id 13 (state.change.logger)
[2024-05-22 17:16:42,166] INFO [Broker id=102] Handling StopReplica request correlationId 14 from controller 103 for 2 partitions (state.change.logger)
[2024-05-22 17:16:42,167] INFO [Broker id=101] Leader topic1-1 with topic id Some(3FJG66WbRtuLJvoJ69Ijiw) starts at leader epoch 2 from offset 459 with partition epoch 3, high watermark 458, ISR [103,101], adding replicas [] and removing replicas [] . Previous leader Some(102) and previous leader epoch was 1. (state.change.logger)
[2024-05-22 17:16:42,177] INFO [Broker id=101] Finished LeaderAndIsr request in 19ms correlationId 6 from controller 103 for 1 partitions (state.change.logger)
[2024-05-22 17:16:42,178] INFO [Broker id=101] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 103 epoch 2 with correlation id 7 (state.change.logger)
[2024-05-22 17:16:42,179] INFO [Broker id=101] Handling LeaderAndIsr request correlationId 8 from controller 103 for 2 partitions (state.change.logger)
[2024-05-22 17:16:42,179] INFO [Broker id=101] Follower topic1-2 starts at leader epoch 2 from offset 0 with partition epoch 3 and high watermark 0. Current leader is 103. Previous leader Some(103) and previous leader epoch was 2. (state.change.logger)
[2024-05-22 17:16:42,179] INFO [Broker id=101] Follower topic1-0 starts at leader epoch 2 from offset 0 with partition epoch 3 and high watermark 0. Current leader is 103. Previous leader Some(103) and previous leader epoch was 2. (state.change.logger)
[2024-05-22 17:16:42,179] INFO [Broker id=101] Stopped fetchers as part of become-follower request from controller 103 epoch 2 with correlation id 8 for 2 partitions (state.change.logger)
[2024-05-22 17:16:42,180] INFO [Broker id=101] Finished LeaderAndIsr request in 1ms correlationId 8 from controller 103 for 2 partitions (state.change.logger)
[2024-05-22 17:16:42,181] INFO [Broker id=101] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 103 epoch 2 with correlation id 9 (state.change.logger)
[2024-05-22 17:16:42,218] INFO [Broker id=101] Handling LeaderAndIsr request correlationId 10 from controller 103 for 3 partitions (state.change.logger)
[2024-05-22 17:16:42,219] INFO [Broker id=101] Ignoring LeaderAndIsr request from controller 103 with correlation id 10 epoch 2 for partition topic1-1 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2024-05-22 17:16:42,219] INFO [Broker id=101] Ignoring LeaderAndIsr request from controller 103 with correlation id 10 epoch 2 for partition topic1-0 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2024-05-22 17:16:42,219] INFO [Broker id=101] Ignoring LeaderAndIsr request from controller 103 with correlation id 10 epoch 2 for partition topic1-2 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2024-05-22 17:16:42,219] INFO [Broker id=101] Finished LeaderAndIsr request in 1ms correlationId 10 from controller 103 for 3 partitions (state.change.logger)
[2024-05-22 17:16:42,220] INFO [Broker id=101] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 103 epoch 2 with correlation id 11 (state.change.logger)
[2024-05-22 17:17:38,303] INFO [Broker id=101] Handling LeaderAndIsr request correlationId 12 from controller 103 for 1 partitions (state.change.logger)
[2024-05-22 17:17:38,305] INFO [Broker id=101] Stopped fetchers as part of LeaderAndIsr request correlationId 12 from controller 103 epoch 2 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-05-22 17:17:38,306] INFO [Broker id=101] Leader topic1-2 with topic id Some(3FJG66WbRtuLJvoJ69Ijiw) starts at leader epoch 3 from offset 0 with partition epoch 4, high watermark 0, ISR [103,101], adding replicas [] and removing replicas [] . Previous leader Some(103) and previous leader epoch was 2. (state.change.logger)
[2024-05-22 17:17:38,310] INFO [Broker id=101] Finished LeaderAndIsr request in 7ms correlationId 12 from controller 103 for 1 partitions (state.change.logger)
[2024-05-22 17:17:38,313] INFO [Broker id=101] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 103 epoch 2 with correlation id 13 (state.change.logger)
[2024-05-22 17:18:00,662] INFO [Broker id=101] Handling LeaderAndIsr request correlationId 14 from controller 103 for 2 partitions (state.change.logger)
[2024-05-22 17:18:00,662] INFO [Broker id=101] Follower topic1-1 starts at leader epoch 3 from offset 537 with partition epoch 4 and high watermark 537. Current leader is 103. Previous leader Some(103) and previous leader epoch was 3. (state.change.logger)
[2024-05-22 17:18:00,662] INFO [Broker id=101] Follower topic1-2 starts at leader epoch 4 from offset 0 with partition epoch 5 and high watermark 0. Current leader is 103. Previous leader Some(103) and previous leader epoch was 4. (state.change.logger)
[2024-05-22 17:18:00,663] INFO [Broker id=101] Stopped fetchers as part of become-follower request from controller 103 epoch 2 with correlation id 14 for 2 partitions (state.change.logger)
[2024-05-22 17:18:00,664] INFO [Broker id=101] Finished LeaderAndIsr request in 2ms correlationId 14 from controller 103 for 2 partitions (state.change.logger)
[2024-05-22 17:18:00,665] INFO [Broker id=101] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 103 epoch 2 with correlation id 15 (state.change.logger)
[2024-05-22 17:18:00,666] INFO [Broker id=101] Handling StopReplica request correlationId 16 from controller 103 for 1 partitions (state.change.logger)
[2024-05-22 17:19:52,196] INFO [Controller id=103 epoch=3] Sending UpdateMetadata request to brokers HashSet(103) for 0 partitions (state.change.logger)
[2024-05-22 17:19:52,212] INFO [Controller id=103 epoch=3] Sending LeaderAndIsr request to broker 103 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-22 17:19:52,213] INFO [Controller id=103 epoch=3] Sending UpdateMetadata request to brokers HashSet(103) for 3 partitions (state.change.logger)
[2024-05-22 17:19:52,220] INFO [Controller id=103 epoch=3] Partition topic1-1 state changed to (Leader:103,ISR:103,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:4,ControllerEpoch:3) after removing replica 101 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-22 17:19:52,221] INFO [Controller id=103 epoch=3] Partition topic1-0 state changed to (Leader:103,ISR:103,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:4,ControllerEpoch:3) after removing replica 101 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-22 17:19:52,221] INFO [Controller id=103 epoch=3] Partition topic1-2 state changed to (Leader:103,ISR:103,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:5,ControllerEpoch:3) after removing replica 101 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-22 17:19:52,223] INFO [Controller id=103 epoch=3] Partition topic1-1 state changed to (Leader:103,ISR:103,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:4,ControllerEpoch:3) after removing replica 102 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-22 17:19:52,224] INFO [Controller id=103 epoch=3] Partition topic1-0 state changed to (Leader:103,ISR:103,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:4,ControllerEpoch:3) after removing replica 102 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-22 17:19:52,224] INFO [Controller id=103 epoch=3] Partition topic1-2 state changed to (Leader:103,ISR:103,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:5,ControllerEpoch:3) after removing replica 102 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-22 17:19:52,224] INFO [Controller id=103 epoch=3] Sending LeaderAndIsr request to broker 103 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-22 17:19:52,224] INFO [Controller id=103 epoch=3] Sending UpdateMetadata request to brokers HashSet(103) for 3 partitions (state.change.logger)
[2024-05-22 17:19:52,338] INFO [Broker id=103] Handling LeaderAndIsr request correlationId 1 from controller 103 for 3 partitions (state.change.logger)
[2024-05-22 17:19:52,347] INFO [Broker id=103] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 103 epoch 3 as part of the become-leader transition for 3 partitions (state.change.logger)
[2024-05-22 17:19:52,354] INFO [Broker id=103] Leader topic1-1 with topic id Some(3FJG66WbRtuLJvoJ69Ijiw) starts at leader epoch 3 from offset 604 with partition epoch 4, high watermark 604, ISR [103], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2024-05-22 17:19:52,357] INFO [Broker id=103] Leader topic1-2 with topic id Some(3FJG66WbRtuLJvoJ69Ijiw) starts at leader epoch 4 from offset 0 with partition epoch 5, high watermark 0, ISR [103], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2024-05-22 17:19:52,372] INFO [Broker id=103] Leader topic1-0 with topic id Some(3FJG66WbRtuLJvoJ69Ijiw) starts at leader epoch 3 from offset 0 with partition epoch 4, high watermark 0, ISR [103], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2024-05-22 17:19:52,379] INFO [Broker id=103] Finished LeaderAndIsr request in 42ms correlationId 1 from controller 103 for 3 partitions (state.change.logger)
[2024-05-22 17:19:52,384] INFO [Broker id=103] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 103 epoch 3 with correlation id 2 (state.change.logger)
[2024-05-22 17:19:52,386] INFO [Broker id=103] Handling LeaderAndIsr request correlationId 3 from controller 103 for 3 partitions (state.change.logger)
[2024-05-22 17:19:52,387] INFO [Broker id=103] Ignoring LeaderAndIsr request from controller 103 with correlation id 3 epoch 3 for partition topic1-1 since its associated leader epoch 3 matches the current leader epoch (state.change.logger)
[2024-05-22 17:19:52,387] INFO [Broker id=103] Ignoring LeaderAndIsr request from controller 103 with correlation id 3 epoch 3 for partition topic1-0 since its associated leader epoch 3 matches the current leader epoch (state.change.logger)
[2024-05-22 17:19:52,387] INFO [Broker id=103] Ignoring LeaderAndIsr request from controller 103 with correlation id 3 epoch 3 for partition topic1-2 since its associated leader epoch 4 matches the current leader epoch (state.change.logger)
[2024-05-22 17:19:52,387] INFO [Broker id=103] Finished LeaderAndIsr request in 1ms correlationId 3 from controller 103 for 3 partitions (state.change.logger)
[2024-05-22 17:19:52,389] INFO [Broker id=103] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 103 epoch 3 with correlation id 4 (state.change.logger)
[2024-05-22 17:20:05,833] ERROR [Controller id=103 epoch=3] Controller 103 epoch 3 failed to change state for partition topic1-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic1-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:576)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:574)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:131)
[2024-05-22 17:20:05,833] ERROR [Controller id=103 epoch=3] Controller 103 epoch 3 failed to change state for partition topic1-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic1-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:576)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:574)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:131)
[2024-05-22 17:20:05,833] ERROR [Controller id=103 epoch=3] Controller 103 epoch 3 failed to change state for partition topic1-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic1-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:576)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:574)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:131)
[2024-05-22 17:20:05,834] INFO [Controller id=103 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-22 17:20:05,834] INFO [Controller id=103 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-22 17:20:10,838] ERROR [Controller id=103 epoch=3] Controller 103 epoch 3 failed to change state for partition topic1-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic1-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:576)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:574)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:131)
[2024-05-22 17:20:10,838] ERROR [Controller id=103 epoch=3] Controller 103 epoch 3 failed to change state for partition topic1-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic1-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:576)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:574)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:131)
[2024-05-22 17:20:10,838] ERROR [Controller id=103 epoch=3] Controller 103 epoch 3 failed to change state for partition topic1-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic1-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:576)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:574)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:131)
[2024-05-22 17:20:10,838] INFO [Controller id=103 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-22 17:20:10,838] INFO [Controller id=103 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-22 17:20:15,844] ERROR [Controller id=103 epoch=3] Controller 103 epoch 3 failed to change state for partition topic1-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic1-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:576)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:574)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:131)
[2024-05-22 17:20:15,845] ERROR [Controller id=103 epoch=3] Controller 103 epoch 3 failed to change state for partition topic1-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic1-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:576)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:574)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:131)
[2024-05-22 17:20:15,845] ERROR [Controller id=103 epoch=3] Controller 103 epoch 3 failed to change state for partition topic1-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic1-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:576)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:574)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1394)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1356)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1356)
	at kafka.controller.KafkaController.process(KafkaController.scala:2612)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:131)
[2024-05-22 17:20:15,846] INFO [Controller id=103 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-22 17:20:15,846] INFO [Controller id=103 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-22 17:20:20,407] INFO [Controller id=102 epoch=4] Sending UpdateMetadata request to brokers HashSet(102) for 0 partitions (state.change.logger)
[2024-05-22 17:20:20,425] INFO [Controller id=102 epoch=4] Sending LeaderAndIsr request to broker 102 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-05-22 17:20:20,427] INFO [Controller id=102 epoch=4] Sending UpdateMetadata request to brokers HashSet(102) for 3 partitions (state.change.logger)
[2024-05-22 17:20:20,432] INFO [Controller id=102 epoch=4] Partition topic1-1 state changed to (Leader:103,ISR:103,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:4,ControllerEpoch:4) after removing replica 101 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-22 17:20:20,433] INFO [Controller id=102 epoch=4] Partition topic1-0 state changed to (Leader:103,ISR:103,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:4,ControllerEpoch:4) after removing replica 101 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-22 17:20:20,433] INFO [Controller id=102 epoch=4] Partition topic1-2 state changed to (Leader:103,ISR:103,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:5,ControllerEpoch:4) after removing replica 101 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-22 17:20:20,442] INFO [Controller id=102 epoch=4] Partition topic1-1 state changed to (Leader:-1,ISR:103,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:5,ControllerEpoch:4) after removing replica 103 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-22 17:20:20,443] INFO [Controller id=102 epoch=4] Partition topic1-0 state changed to (Leader:-1,ISR:103,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:5,ControllerEpoch:4) after removing replica 103 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-22 17:20:20,443] INFO [Controller id=102 epoch=4] Partition topic1-2 state changed to (Leader:-1,ISR:103,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:6,ControllerEpoch:4) after removing replica 103 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-22 17:20:20,444] INFO [Controller id=102 epoch=4] Sending LeaderAndIsr request to broker 102 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-05-22 17:20:20,444] INFO [Controller id=102 epoch=4] Sending UpdateMetadata request to brokers HashSet(102) for 3 partitions (state.change.logger)
[2024-05-22 17:20:20,466] ERROR [Controller id=102 epoch=4] Controller 102 epoch 4 failed to change state for partition topic1-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic1-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:576)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:574)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:317)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1568)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1475)
	at kafka.controller.KafkaController.process(KafkaController.scala:2656)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:131)
[2024-05-22 17:20:20,466] ERROR [Controller id=102 epoch=4] Controller 102 epoch 4 failed to change state for partition topic1-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic1-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:576)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:574)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:317)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1568)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1475)
	at kafka.controller.KafkaController.process(KafkaController.scala:2656)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:131)
[2024-05-22 17:20:20,466] ERROR [Controller id=102 epoch=4] Controller 102 epoch 4 failed to change state for partition topic1-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic1-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:576)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:574)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:44)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:317)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1568)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1475)
	at kafka.controller.KafkaController.process(KafkaController.scala:2656)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:131)
[2024-05-22 17:20:20,467] INFO [Controller id=102 epoch=4] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-22 17:20:20,550] INFO [Broker id=102] Handling LeaderAndIsr request correlationId 1 from controller 102 for 3 partitions (state.change.logger)
[2024-05-22 17:20:20,561] ERROR [Broker id=102] Received LeaderAndIsrRequest with correlation id 1 from controller 102 epoch 4 for partition topic1-1 (last update controller epoch 2) but cannot become follower since the new leader 103 is unavailable. (state.change.logger)
[2024-05-22 17:20:20,564] ERROR [Broker id=102] Received LeaderAndIsrRequest with correlation id 1 from controller 102 epoch 4 for partition topic1-2 (last update controller epoch 2) but cannot become follower since the new leader 103 is unavailable. (state.change.logger)
[2024-05-22 17:20:20,564] ERROR [Broker id=102] Received LeaderAndIsrRequest with correlation id 1 from controller 102 epoch 4 for partition topic1-0 (last update controller epoch 2) but cannot become follower since the new leader 103 is unavailable. (state.change.logger)
[2024-05-22 17:20:20,565] INFO [Broker id=102] Stopped fetchers as part of become-follower request from controller 102 epoch 4 with correlation id 1 for 0 partitions (state.change.logger)
[2024-05-22 17:20:20,571] INFO [Broker id=102] Finished LeaderAndIsr request in 21ms correlationId 1 from controller 102 for 3 partitions (state.change.logger)
[2024-05-22 17:20:20,577] INFO [Broker id=102] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 2 (state.change.logger)
[2024-05-22 17:20:20,579] INFO [Broker id=102] Handling LeaderAndIsr request correlationId 3 from controller 102 for 3 partitions (state.change.logger)
[2024-05-22 17:20:20,579] ERROR [Broker id=102] Received LeaderAndIsrRequest with correlation id 3 from controller 102 epoch 4 for partition topic1-1 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-22 17:20:20,579] ERROR [Broker id=102] Received LeaderAndIsrRequest with correlation id 3 from controller 102 epoch 4 for partition topic1-2 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-22 17:20:20,579] ERROR [Broker id=102] Received LeaderAndIsrRequest with correlation id 3 from controller 102 epoch 4 for partition topic1-0 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-22 17:20:20,580] INFO [Broker id=102] Stopped fetchers as part of become-follower request from controller 102 epoch 4 with correlation id 3 for 0 partitions (state.change.logger)
[2024-05-22 17:20:20,580] INFO [Broker id=102] Finished LeaderAndIsr request in 1ms correlationId 3 from controller 102 for 3 partitions (state.change.logger)
[2024-05-22 17:20:20,581] INFO [Broker id=102] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 4 (state.change.logger)
[2024-05-22 17:20:26,928] INFO [Controller id=102 epoch=4] Sending UpdateMetadata request to brokers HashSet(102) for 0 partitions (state.change.logger)
[2024-05-22 17:20:26,928] INFO [Controller id=102 epoch=4] Sending UpdateMetadata request to brokers HashSet(101) for 3 partitions (state.change.logger)
[2024-05-22 17:20:26,930] INFO [Controller id=102 epoch=4] Sending LeaderAndIsr request to broker 101 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-05-22 17:20:26,930] INFO [Controller id=102 epoch=4] Sending UpdateMetadata request to brokers HashSet(101, 102) for 3 partitions (state.change.logger)
[2024-05-22 17:20:26,931] INFO [Broker id=102] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 6 (state.change.logger)
[2024-05-22 17:20:26,932] ERROR [Controller id=102 epoch=4] Controller 102 epoch 4 failed to change state for partition topic1-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic1-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:576)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:574)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:590)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1644)
	at kafka.controller.KafkaController.process(KafkaController.scala:2620)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:131)
[2024-05-22 17:20:26,933] ERROR [Controller id=102 epoch=4] Controller 102 epoch 4 failed to change state for partition topic1-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic1-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:576)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:574)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:590)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1644)
	at kafka.controller.KafkaController.process(KafkaController.scala:2620)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:131)
[2024-05-22 17:20:26,933] ERROR [Controller id=102 epoch=4] Controller 102 epoch 4 failed to change state for partition topic1-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic1-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:433)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:576)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:574)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:933)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:430)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:336)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:242)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:162)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:76)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:61)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:590)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1644)
	at kafka.controller.KafkaController.process(KafkaController.scala:2620)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:54)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:138)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:141)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1$adapted(ControllerEventManager.scala:141)
	at com.yammer.metrics.core.Timer.time(Timer.java:91)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:141)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:131)
[2024-05-22 17:20:26,933] INFO [Controller id=102 epoch=4] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-22 17:20:27,055] INFO [Broker id=101] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 0 (state.change.logger)
[2024-05-22 17:20:27,072] INFO [Broker id=101] Handling LeaderAndIsr request correlationId 1 from controller 102 for 3 partitions (state.change.logger)
[2024-05-22 17:20:27,084] ERROR [Broker id=101] Received LeaderAndIsrRequest with correlation id 1 from controller 102 epoch 4 for partition topic1-1 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-22 17:20:27,087] ERROR [Broker id=101] Received LeaderAndIsrRequest with correlation id 1 from controller 102 epoch 4 for partition topic1-2 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-22 17:20:27,087] ERROR [Broker id=101] Received LeaderAndIsrRequest with correlation id 1 from controller 102 epoch 4 for partition topic1-0 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-22 17:20:27,088] INFO [Broker id=101] Stopped fetchers as part of become-follower request from controller 102 epoch 4 with correlation id 1 for 0 partitions (state.change.logger)
[2024-05-22 17:20:27,093] INFO [Broker id=101] Finished LeaderAndIsr request in 21ms correlationId 1 from controller 102 for 3 partitions (state.change.logger)
[2024-05-22 17:20:27,096] INFO [Broker id=101] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 2 (state.change.logger)
[2024-05-22 17:21:54,737] INFO [Controller id=102 epoch=4] Sending UpdateMetadata request to brokers HashSet(101, 102) for 0 partitions (state.change.logger)
[2024-05-22 17:21:54,737] INFO [Controller id=102 epoch=4] Sending UpdateMetadata request to brokers HashSet(103) for 3 partitions (state.change.logger)
[2024-05-22 17:21:54,738] INFO [Controller id=102 epoch=4] Sending LeaderAndIsr request to broker 103 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-05-22 17:21:54,738] INFO [Controller id=102 epoch=4] Sending UpdateMetadata request to brokers HashSet(101, 102, 103) for 3 partitions (state.change.logger)
[2024-05-22 17:21:54,739] INFO [Broker id=102] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 8 (state.change.logger)
[2024-05-22 17:21:54,739] INFO [Broker id=101] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 4 (state.change.logger)
[2024-05-22 17:21:54,746] INFO [Controller id=102 epoch=4] Changed partition topic1-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=103, leaderEpoch=5, isrWithBrokerEpoch=List(BrokerState(brokerId=103, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2024-05-22 17:21:54,746] INFO [Controller id=102 epoch=4] Changed partition topic1-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=103, leaderEpoch=5, isrWithBrokerEpoch=List(BrokerState(brokerId=103, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=6) (state.change.logger)
[2024-05-22 17:21:54,746] INFO [Controller id=102 epoch=4] Changed partition topic1-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=103, leaderEpoch=6, isrWithBrokerEpoch=List(BrokerState(brokerId=103, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=7) (state.change.logger)
[2024-05-22 17:21:54,746] INFO [Controller id=102 epoch=4] Sending LeaderAndIsr request to broker 101 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-05-22 17:21:54,746] INFO [Controller id=102 epoch=4] Sending LeaderAndIsr request to broker 102 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-05-22 17:21:54,746] INFO [Controller id=102 epoch=4] Sending LeaderAndIsr request to broker 103 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-22 17:21:54,746] INFO [Controller id=102 epoch=4] Sending UpdateMetadata request to brokers HashSet(101, 102, 103) for 3 partitions (state.change.logger)
[2024-05-22 17:21:54,747] INFO [Broker id=102] Handling LeaderAndIsr request correlationId 9 from controller 102 for 3 partitions (state.change.logger)
[2024-05-22 17:21:54,747] INFO [Broker id=101] Handling LeaderAndIsr request correlationId 5 from controller 102 for 3 partitions (state.change.logger)
[2024-05-22 17:21:54,748] INFO [Broker id=102] Follower topic1-1 starts at leader epoch 5 from offset 459 with partition epoch 6 and high watermark 459. Current leader is 103. Previous leader Some(103) and previous leader epoch was 5. (state.change.logger)
[2024-05-22 17:21:54,748] INFO [Broker id=102] Follower topic1-2 starts at leader epoch 6 from offset 0 with partition epoch 7 and high watermark 0. Current leader is 103. Previous leader Some(103) and previous leader epoch was 6. (state.change.logger)
[2024-05-22 17:21:54,748] INFO [Broker id=102] Follower topic1-0 starts at leader epoch 5 from offset 0 with partition epoch 6 and high watermark 0. Current leader is 103. Previous leader Some(103) and previous leader epoch was 5. (state.change.logger)
[2024-05-22 17:21:54,749] INFO [Broker id=102] Stopped fetchers as part of become-follower request from controller 102 epoch 4 with correlation id 9 for 3 partitions (state.change.logger)
[2024-05-22 17:21:54,749] INFO [Broker id=101] Follower topic1-1 starts at leader epoch 5 from offset 537 with partition epoch 6 and high watermark 537. Current leader is 103. Previous leader Some(103) and previous leader epoch was 5. (state.change.logger)
[2024-05-22 17:21:54,749] INFO [Broker id=101] Follower topic1-2 starts at leader epoch 6 from offset 0 with partition epoch 7 and high watermark 0. Current leader is 103. Previous leader Some(103) and previous leader epoch was 6. (state.change.logger)
[2024-05-22 17:21:54,749] INFO [Broker id=101] Follower topic1-0 starts at leader epoch 5 from offset 0 with partition epoch 6 and high watermark 0. Current leader is 103. Previous leader Some(103) and previous leader epoch was 5. (state.change.logger)
[2024-05-22 17:21:54,749] INFO [Broker id=101] Stopped fetchers as part of become-follower request from controller 102 epoch 4 with correlation id 5 for 3 partitions (state.change.logger)
[2024-05-22 17:21:54,765] INFO [Broker id=102] Finished LeaderAndIsr request in 18ms correlationId 9 from controller 102 for 3 partitions (state.change.logger)
[2024-05-22 17:21:54,767] INFO [Broker id=102] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 10 (state.change.logger)
[2024-05-22 17:21:54,769] INFO [Broker id=101] Finished LeaderAndIsr request in 22ms correlationId 5 from controller 102 for 3 partitions (state.change.logger)
[2024-05-22 17:21:54,771] INFO [Broker id=101] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 6 (state.change.logger)
[2024-05-22 17:21:54,870] INFO [Broker id=103] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 0 (state.change.logger)
[2024-05-22 17:21:54,889] INFO [Broker id=103] Handling LeaderAndIsr request correlationId 1 from controller 102 for 3 partitions (state.change.logger)
[2024-05-22 17:21:54,901] ERROR [Broker id=103] Received LeaderAndIsrRequest with correlation id 1 from controller 102 epoch 4 for partition topic1-1 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-22 17:21:54,904] ERROR [Broker id=103] Received LeaderAndIsrRequest with correlation id 1 from controller 102 epoch 4 for partition topic1-2 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-22 17:21:54,904] ERROR [Broker id=103] Received LeaderAndIsrRequest with correlation id 1 from controller 102 epoch 4 for partition topic1-0 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-22 17:21:54,905] INFO [Broker id=103] Stopped fetchers as part of become-follower request from controller 102 epoch 4 with correlation id 1 for 0 partitions (state.change.logger)
[2024-05-22 17:21:54,912] INFO [Broker id=103] Finished LeaderAndIsr request in 24ms correlationId 1 from controller 102 for 3 partitions (state.change.logger)
[2024-05-22 17:21:54,916] INFO [Broker id=103] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 2 (state.change.logger)
[2024-05-22 17:21:54,918] INFO [Broker id=103] Handling LeaderAndIsr request correlationId 3 from controller 102 for 3 partitions (state.change.logger)
[2024-05-22 17:21:54,921] INFO [Broker id=103] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 102 epoch 4 as part of the become-leader transition for 3 partitions (state.change.logger)
[2024-05-22 17:21:54,926] INFO [Broker id=103] Leader topic1-1 with topic id Some(3FJG66WbRtuLJvoJ69Ijiw) starts at leader epoch 5 from offset 672 with partition epoch 6, high watermark 672, ISR [103], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2024-05-22 17:21:54,931] INFO [Broker id=103] Leader topic1-2 with topic id Some(3FJG66WbRtuLJvoJ69Ijiw) starts at leader epoch 6 from offset 0 with partition epoch 7, high watermark 0, ISR [103], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2024-05-22 17:21:54,934] INFO [Broker id=103] Leader topic1-0 with topic id Some(3FJG66WbRtuLJvoJ69Ijiw) starts at leader epoch 5 from offset 0 with partition epoch 6, high watermark 0, ISR [103], adding replicas [] and removing replicas [] . Previous leader None and previous leader epoch was -1. (state.change.logger)
[2024-05-22 17:21:54,938] INFO [Broker id=103] Finished LeaderAndIsr request in 20ms correlationId 3 from controller 102 for 3 partitions (state.change.logger)
[2024-05-22 17:21:54,939] INFO [Broker id=103] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 4 (state.change.logger)
[2024-05-22 17:21:55,806] INFO [Controller id=102 epoch=4] Sending UpdateMetadata request to brokers HashSet(101, 102, 103) for 2 partitions (state.change.logger)
[2024-05-22 17:21:55,807] INFO [Broker id=102] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 11 (state.change.logger)
[2024-05-22 17:21:55,807] INFO [Broker id=101] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 7 (state.change.logger)
[2024-05-22 17:21:55,807] INFO [Broker id=103] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 5 (state.change.logger)
[2024-05-22 17:21:55,822] INFO [Controller id=102 epoch=4] Sending UpdateMetadata request to brokers HashSet(101, 102, 103) for 1 partitions (state.change.logger)
[2024-05-22 17:21:55,823] INFO [Broker id=102] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 12 (state.change.logger)
[2024-05-22 17:21:55,823] INFO [Broker id=103] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 6 (state.change.logger)
[2024-05-22 17:21:55,823] INFO [Broker id=101] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 8 (state.change.logger)
[2024-05-22 17:21:55,826] INFO [Controller id=102 epoch=4] Sending UpdateMetadata request to brokers HashSet(101, 102, 103) for 2 partitions (state.change.logger)
[2024-05-22 17:21:55,826] INFO [Broker id=102] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 13 (state.change.logger)
[2024-05-22 17:21:55,827] INFO [Broker id=101] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 9 (state.change.logger)
[2024-05-22 17:21:55,827] INFO [Broker id=103] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 7 (state.change.logger)
[2024-05-22 17:21:56,236] INFO [Controller id=102 epoch=4] Sending UpdateMetadata request to brokers HashSet(101, 102, 103) for 1 partitions (state.change.logger)
[2024-05-22 17:21:56,237] INFO [Broker id=102] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 14 (state.change.logger)
[2024-05-22 17:21:56,238] INFO [Broker id=103] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 8 (state.change.logger)
[2024-05-22 17:21:56,238] INFO [Broker id=101] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 10 (state.change.logger)
[2024-05-22 17:22:10,276] INFO [Controller id=102 epoch=4] Changed partition topic1-1 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=102, leaderEpoch=6, isrWithBrokerEpoch=List(BrokerState(brokerId=101, brokerEpoch=-1), BrokerState(brokerId=102, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=9) (state.change.logger)
[2024-05-22 17:22:10,276] INFO [Controller id=102 epoch=4] Changed partition topic1-0 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=102, leaderEpoch=6, isrWithBrokerEpoch=List(BrokerState(brokerId=102, brokerEpoch=-1), BrokerState(brokerId=101, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=9) (state.change.logger)
[2024-05-22 17:22:10,276] INFO [Controller id=102 epoch=4] Changed partition topic1-2 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=101, leaderEpoch=7, isrWithBrokerEpoch=List(BrokerState(brokerId=101, brokerEpoch=-1), BrokerState(brokerId=102, brokerEpoch=-1)), leaderRecoveryState=RECOVERED, partitionEpoch=10) (state.change.logger)
[2024-05-22 17:22:10,276] INFO [Controller id=102 epoch=4] Sending LeaderAndIsr request to broker 101 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2024-05-22 17:22:10,276] INFO [Controller id=102 epoch=4] Sending LeaderAndIsr request to broker 102 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2024-05-22 17:22:10,277] INFO [Controller id=102 epoch=4] Sending LeaderAndIsr request to broker 103 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-05-22 17:22:10,277] INFO [Controller id=102 epoch=4] Sending UpdateMetadata request to brokers HashSet(101, 102, 103) for 3 partitions (state.change.logger)
[2024-05-22 17:22:10,277] INFO [Broker id=102] Handling LeaderAndIsr request correlationId 15 from controller 102 for 3 partitions (state.change.logger)
[2024-05-22 17:22:10,277] INFO [Broker id=101] Handling LeaderAndIsr request correlationId 11 from controller 102 for 3 partitions (state.change.logger)
[2024-05-22 17:22:10,278] INFO [Broker id=103] Handling LeaderAndIsr request correlationId 9 from controller 102 for 3 partitions (state.change.logger)
[2024-05-22 17:22:10,278] INFO [Controller id=102 epoch=4] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-22 17:22:10,280] INFO [Broker id=103] Follower topic1-1 starts at leader epoch 6 from offset 787 with partition epoch 9 and high watermark 787. Current leader is 102. Previous leader Some(102) and previous leader epoch was 6. (state.change.logger)
[2024-05-22 17:22:10,280] INFO [Broker id=103] Follower topic1-2 starts at leader epoch 7 from offset 0 with partition epoch 10 and high watermark 0. Current leader is 101. Previous leader Some(101) and previous leader epoch was 7. (state.change.logger)
[2024-05-22 17:22:10,280] INFO [Broker id=102] Stopped fetchers as part of LeaderAndIsr request correlationId 15 from controller 102 epoch 4 as part of the become-leader transition for 2 partitions (state.change.logger)
[2024-05-22 17:22:10,280] INFO [Broker id=103] Follower topic1-0 starts at leader epoch 6 from offset 0 with partition epoch 9 and high watermark 0. Current leader is 102. Previous leader Some(102) and previous leader epoch was 6. (state.change.logger)
[2024-05-22 17:22:10,280] INFO [Broker id=103] Stopped fetchers as part of become-follower request from controller 102 epoch 4 with correlation id 9 for 3 partitions (state.change.logger)
[2024-05-22 17:22:10,280] INFO [Broker id=101] Stopped fetchers as part of LeaderAndIsr request correlationId 11 from controller 102 epoch 4 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-05-22 17:22:10,283] INFO [Broker id=102] Leader topic1-1 with topic id Some(3FJG66WbRtuLJvoJ69Ijiw) starts at leader epoch 6 from offset 787 with partition epoch 9, high watermark 786, ISR [101,102], adding replicas [] and removing replicas [] . Previous leader Some(103) and previous leader epoch was 5. (state.change.logger)
[2024-05-22 17:22:10,285] INFO [Broker id=103] Finished LeaderAndIsr request in 7ms correlationId 9 from controller 102 for 3 partitions (state.change.logger)
[2024-05-22 17:22:10,285] INFO [Broker id=101] Leader topic1-2 with topic id Some(3FJG66WbRtuLJvoJ69Ijiw) starts at leader epoch 7 from offset 0 with partition epoch 10, high watermark 0, ISR [101,102], adding replicas [] and removing replicas [] . Previous leader Some(103) and previous leader epoch was 6. (state.change.logger)
[2024-05-22 17:22:10,292] INFO [Broker id=102] Leader topic1-0 with topic id Some(3FJG66WbRtuLJvoJ69Ijiw) starts at leader epoch 6 from offset 0 with partition epoch 9, high watermark 0, ISR [102,101], adding replicas [] and removing replicas [] . Previous leader Some(103) and previous leader epoch was 5. (state.change.logger)
[2024-05-22 17:22:10,292] INFO [Broker id=101] Follower topic1-1 starts at leader epoch 6 from offset 787 with partition epoch 9 and high watermark 786. Current leader is 102. Previous leader Some(102) and previous leader epoch was 6. (state.change.logger)
[2024-05-22 17:22:10,292] INFO [Broker id=101] Follower topic1-0 starts at leader epoch 6 from offset 0 with partition epoch 9 and high watermark 0. Current leader is 102. Previous leader Some(102) and previous leader epoch was 6. (state.change.logger)
[2024-05-22 17:22:10,293] INFO [Broker id=101] Stopped fetchers as part of become-follower request from controller 102 epoch 4 with correlation id 11 for 2 partitions (state.change.logger)
[2024-05-22 17:22:10,295] INFO [Broker id=102] Follower topic1-2 starts at leader epoch 7 from offset 0 with partition epoch 10 and high watermark 0. Current leader is 101. Previous leader Some(101) and previous leader epoch was 7. (state.change.logger)
[2024-05-22 17:22:10,296] INFO [Broker id=102] Stopped fetchers as part of become-follower request from controller 102 epoch 4 with correlation id 15 for 1 partitions (state.change.logger)
[2024-05-22 17:22:10,298] INFO [Broker id=101] Finished LeaderAndIsr request in 21ms correlationId 11 from controller 102 for 3 partitions (state.change.logger)
[2024-05-22 17:22:10,300] INFO [Broker id=101] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 12 (state.change.logger)
[2024-05-22 17:22:10,301] INFO [Broker id=102] Finished LeaderAndIsr request in 24ms correlationId 15 from controller 102 for 3 partitions (state.change.logger)
[2024-05-22 17:22:10,303] INFO [Broker id=102] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 16 (state.change.logger)
[2024-05-22 17:22:10,351] INFO [Controller id=102 epoch=4] Partition topic1-1 state changed to (Leader:102,ISR:101,102,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:9,ControllerEpoch:4) after removing replica 103 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-22 17:22:10,351] INFO [Controller id=102 epoch=4] Partition topic1-0 state changed to (Leader:102,ISR:102,101,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:9,ControllerEpoch:4) after removing replica 103 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-22 17:22:10,351] INFO [Controller id=102 epoch=4] Partition topic1-2 state changed to (Leader:101,ISR:101,102,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:10,ControllerEpoch:4) after removing replica 103 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-22 17:22:10,352] INFO [Controller id=102 epoch=4] Sending LeaderAndIsr request to broker 101 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2024-05-22 17:22:10,352] INFO [Controller id=102 epoch=4] Sending LeaderAndIsr request to broker 102 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2024-05-22 17:22:10,352] INFO [Controller id=102 epoch=4] Sending UpdateMetadata request to brokers HashSet(101, 102) for 3 partitions (state.change.logger)
[2024-05-22 17:22:10,352] INFO [Broker id=102] Handling LeaderAndIsr request correlationId 17 from controller 102 for 3 partitions (state.change.logger)
[2024-05-22 17:22:10,352] INFO [Broker id=101] Handling LeaderAndIsr request correlationId 13 from controller 102 for 3 partitions (state.change.logger)
[2024-05-22 17:22:10,353] INFO [Broker id=102] Ignoring LeaderAndIsr request from controller 102 with correlation id 17 epoch 4 for partition topic1-1 since its associated leader epoch 6 matches the current leader epoch (state.change.logger)
[2024-05-22 17:22:10,353] INFO [Broker id=102] Ignoring LeaderAndIsr request from controller 102 with correlation id 17 epoch 4 for partition topic1-0 since its associated leader epoch 6 matches the current leader epoch (state.change.logger)
[2024-05-22 17:22:10,353] INFO [Broker id=102] Ignoring LeaderAndIsr request from controller 102 with correlation id 17 epoch 4 for partition topic1-2 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2024-05-22 17:22:10,353] INFO [Broker id=101] Ignoring LeaderAndIsr request from controller 102 with correlation id 13 epoch 4 for partition topic1-1 since its associated leader epoch 6 matches the current leader epoch (state.change.logger)
[2024-05-22 17:22:10,353] INFO [Broker id=102] Finished LeaderAndIsr request in 1ms correlationId 17 from controller 102 for 3 partitions (state.change.logger)
[2024-05-22 17:22:10,353] INFO [Broker id=101] Ignoring LeaderAndIsr request from controller 102 with correlation id 13 epoch 4 for partition topic1-0 since its associated leader epoch 6 matches the current leader epoch (state.change.logger)
[2024-05-22 17:22:10,353] INFO [Broker id=101] Ignoring LeaderAndIsr request from controller 102 with correlation id 13 epoch 4 for partition topic1-2 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2024-05-22 17:22:10,353] INFO [Broker id=101] Finished LeaderAndIsr request in 1ms correlationId 13 from controller 102 for 3 partitions (state.change.logger)
[2024-05-22 17:22:10,354] INFO [Broker id=102] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 18 (state.change.logger)
[2024-05-22 17:22:10,354] INFO [Broker id=101] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 102 epoch 4 with correlation id 14 (state.change.logger)
